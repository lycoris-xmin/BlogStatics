$(function(){function t(){let t=void 0;const n=e($(".skill-item>div"));n&&(t=n,n.select()),h=t}function e(t){let e=void 0;if(t&&t.length){if(1==t.length){var n=t[0].getBoundingClientRect();u.x>=n.left&&u.x<=n.right&&u.y>=n.top&&u.y<=n.bottom&&(e=t)}return t.each((t,n)=>{var i=n.getBoundingClientRect();u.x>=i.left&&u.x<=i.right&&u.y>=i.top&&u.y<=i.bottom&&(e=$(n))}),e}}async function n(){try{const t=await a("info");if(console.log(t),t)for(let e in t){const n=$("#info").find(`p[${e}]`);if(n&&n.length){const i=t[e];if("tags"==e){let t="<span>博主很懒，并没有设置标签</span>";if(i&&i.length){t="";for(let e of i)t=t.concat(`<span>${e}</span>`)}n.html(t)}else"sex"==e?n.text(0==i?"保密":1==i?"男":"女"):n.text(i)}}}catch(t){console.error(t)}}async function i(){try{const t=await a("skill");if(t)for(let e in t)if(t[e]&&t[e].length){const n=$(`div.progress[data-type="${e}"]`);let i="";for(let n of t[e])i=i.concat(`\n              <div>\n                <p>${n.name}</p>\n                <div class="progress__item">\n                  <div class="progress__bar" style="width:${n.proficiency}%"></div>\n                </div>\n              </div>\n              `);n.html(i)}}catch(t){console.error(t)}}async function o(){try{const t=await a("contact");t.qq?$("#qq-qrcode").find(".qrcode").html(`<img src="${t.qq}" onerror="javascript:this.src='/statics/images/404.png'" />`):$("#qq-qrcode").remove(),t.weChat?$("#wechat-qrcode").find(".qrcode").html(`<img src="${t.weChat}" onerror="javascript:this.src='/statics/images/404.png'" />`):$("#wechat-qrcode").remove()}catch(t){console.error(t)}}async function r(){try{const t=$.createHttpRequest();t.url="/user/owner/link";const e=await t.get();if(e&&0==e.resCode)for(let t in e.data){const n=$(".other-link").find(`a[${t}]`);if(n&&n.length){n.attr("href",e.data[t]).attr("target","_blank");const i=n.find("img");i.attr("src",i.attr("data-src")),i.removeAttr("data-src")}}}catch(t){console.error(t)}}async function a(t){const e=$.createHttpRequest();e.url=`/home/about/me/${t}`;const n=await e.get();return n&&0==n.resCode?n.data:void 0}async function c(t){const e={clientOrign:clientOrign,route:`${location.pathname}${location.search}`,pageName:t,referer:document.referrer,isPost:!1},n=await db.query(t=>t.route==e.route);if(!(n&&n.length&&n[0].time+3e5>+new Date))try{const t=$.createHttpRequest();t.url="/home/browse/record",t.data=e,await t.post(),n&&n.length?(n[0].time=+new Date,db.update(n[0])):db.create({route:e.route,time:+new Date})}catch(t){console.error(t)}}const s=$("div.wraper"),l=$("ul.menus").find("li"),f=$("div.section-wrap");let d=!1,h=void 0;const u={x:0,y:0};l.on("click",function(e){if(!d){if(d=!0,$("div.section").find(".section-body").fadeOut(300,function(){$(this).removeClass("animation")}),e.target==e.currentTarget){l.removeClass("active"),$(this).addClass("active");const e=$(this).find("a").attr("href");f.removeClass("author info skill hobby contactus").addClass(e.replace("#","")),setTimeout(()=>{$(e).find(".section-body").fadeIn(300,function(){"#skill"==e&&($(this).find(".skill-item>div").each((t,e)=>{e.scrollTop>0&&(e.scrollTop=0)}),t())}).addClass("animation")},500)}d&&setTimeout(()=>{d=!1},1e3)}}),l.find("a").on("click",function(){$(this).parent().trigger("click")});const g=$.debounce(function(t){if(h)return;const e=$(t.target).parents().filter(function(){return $(this).hasClass("progress")});if(!(e&&e.length&&e.parent().height()<e[0].scrollHeight))if(t.preventDefault(),t.originalEvent.deltaY>0){const t=l.parent().find("li.active").next();if(!t||!t.length||t.hasClass("slide"))return;t.trigger("click")}else{const t=l.parent().find("li.active").prev();if(!t||!t.length)return;t.trigger("click")}},200);s.mousemove($.debounce(function(e){u.x=e.pageX,u.y=e.pageY,f.hasClass("skill")&&t()},100)),s.on("wheel",function(t){d||g.call(this,t)}),this.init=function(){n(),window.onresize=(()=>{location.reload()}),i(),o(),r(),c("关于我")},this.init()});