$(function(){function t(t){function a(t){let a="";if(t&&t.length){a=a.concat('<div class="tags">');for(let n of t)a=a.concat(`<span>${n}</span>`);a=a.concat("</div>")}return a}let n="";if(t&&t.length)for(let e of t)n=n.concat(`\n        <li class="card">\n          <div class="icon">\n              <img data-src="${e.icon}" onerror="javascript:this.src='/statics/images/404.png'" class="lazyload"/>\n          </div>\n          <div class="post">\n            <div>\n                <div class="title flex-start-center">\n                    <span class="post-badge post-badge-${0==e.type?"primary":"purple"}">${0==e.type?"原创":"转载"}</span>\n                    <a href="/post/${e.id}">${e.title}</a>\n                </div>\n                <div class="info">\n                    <p class="info-text">${e.info}</p>\n                    <div class="flex-start-center">\n                        <div class="${e.categoryName?"category-link":""}">${e.categoryName||"未分类"}</div>\n\n                        <div class="has-icon"><i class="mdi mdi-cards-heart"></i><span class="value">${e.browse}</span></div>\n\n                        <div class="has-icon"><i class="mdi mdi-comment"></i><span class="value">${e.comment}</span></div>\n\n                        ${a(e.tags)}\n                    </div>\n                </div>\n            </div>\n          </div>\n        </li>\n        `);return n}async function a(){o.post.busy.show(),o.post.body.html("");try{const a=$.createHttpRequest();a.url="/post/list",a.data={pageIndex:l.pageIndex,pageSize:l.pageSize},l.category&&(a.data.category=l.category);const n=await a.get();if(n&&0==n.resCode){l.maxPageIndex=$.getMaxPageIndex(n.data.count,l.pageSize);const a=t(n.data.list);a&&(o.post.body.html(a),window.lycoris.lazysizes())}}finally{o.post.busy.hide()}}function n(t){if(t=t||1,l.maxPageIndex>1){const a=$.getPageNumber(t,l.maxPageIndex);let n="";n='\n    <li class="page-item page-btn" data-index="-1">\n      <span class="page-link">上一页</span>\n    </li>\n    ';for(let e of a)n+=`\n      <li class="page-item page-number ${e==t?"active":""}" data-index="${e}">\n        <span class="page-link">${e}</span>\n      </li>\n      `;n+='\n    <li class="page-item page-btn" data-index="1">\n      <span class="page-link">下一页</span>\n    </li>\n    ',o.pagination.html(n),e()}else o.pagination.parent().remove()}function e(){o.pagination.find(">li.page-number").on("click",async function(){const t=$(this).data("index");l.pageIndex!=t&&(l.pageIndex=t,l.maxPageIndex>t?n($(this).data("index")):(o.pagination.find(">li.page-number").removeClass("active"),$(this).addClass("active")),await a())}),o.pagination.find(">li.page-btn").on("click",function(){const t=parseInt($(this).data("index"));let a=l.pageIndex+t;a<1||a>l.maxPageIndex||o.pagination.find(`>li.page-number[data-index="${a}"]`).trigger("click")})}function i(){try{const e=parseInt($("div.clock").find(".column").css("font-size").replace("px",""));let i,s,c=[...$("div.clock").find(".column")],o=["visible","close","far","far","distant","distant"],l=!0;function t(t,a){return t+("0"+a).slice(-2)}function a(){return i=new Date,[l?i.getHours():i.getHours()%12||12,i.getMinutes(),i.getSeconds()].reduce(t,"")}function n(t,a){return o.find((n,e)=>Math.abs(t-a)===e)||""}const r=$("div.clock").height();setInterval(()=>{s=a(),c.forEach((t,a)=>{let i=+s[a],c=-i*e;t.style.transform=`translateY(calc(${r/2}px + ${c}px - ${e/2}px))`,Array.from(t.children).forEach((t,a)=>{t.className="num "+n(i,a)})})},200+10*Math.E)}catch(t){console.error(t)}}async function s(){try{const t=$.createHttpRequest();t.url="/post/recommend/list";const a=await t.get();return a&&0==a.resCode?a.data.list:[]}catch(t){return console.error(t),[]}}async function c(){function t(t,a){if(e.hasClass("transition"))return;e.addClass("transition");const n=e.find("div.wrap");n.css("transform",`translateX(${-t*a}px)`),$(".carousel-item:nth-child(3)").addClass("active"),setTimeout(()=>{t<0?$(".carousel-item:first").before($(".carousel-item:last")):t>0&&$(".carousel-item:last").after($(".carousel-item:first")),e.removeClass("transition"),n.css("transform","translateX(0px)"),setTimeout(()=>{$(".carousel-item:nth-child(2)").removeClass("active")},500)},750)}function a(t){return`\n      <div class="carousel-item">\n        <div class="carousel-bg" style="background-image: url(${t.icon?t.icon:"/statics/images/404.png"})">\n        </div>\n        <div class="carousel-container">\n          <div>\n              <a href="/post/${t.id}"><h2 title="${t.title}">${t.title}</h2></a>\n              <p>${t.info}</p>\n          </div>\n        </div>\n      </div>\n      `}function n(a){t(1,a),i=setTimeout(()=>{n(a)},5500)}const e=$("div.carousel");let i=void 0,c=await s();if(c&&c.length){c.length<3&&(c=[...c,...c]);let s="";c.forEach(t=>s=s.concat(a(t))),e.find(".wrap").html(s);const o=e.find("div.carousel-item").width();e.find(".wrap").css("left",`-${o}px`),e.parent().find("div.carousel-prev>span").on("click",()=>{i&&clearTimeout(i),t(-1,o),i=setTimeout(()=>{n(o)},4500)}),e.parent().find("div.carousel-next>span").on("click",()=>{i&&clearTimeout(i),t(1,o),i=setTimeout(()=>{n(o)},4500)}),i=setTimeout(()=>{n(o)},4500)}e.parent().find("div.line-loading-preloader").fadeOut(function(){$(this).remove()})}const o={post:{busy:$("div.post-list").lineBusy(),body:$("div.post-list").find("ul")},category:$(".category"),pagination:$("div.pagination-btn").find("ul.pagination")},l={pageIndex:1,pageSize:10,category:void 0,maxPageIndex:1},r=$.debounce(a,500);o.category.find("li").on("click",function(){$(this).hasClass("active")||(o.category.find(".active").removeClass("active"),$(this).addClass("active"),l.category=$(this).attr("data-category"),r())}),o.category.find(".mdi").on("click",function(){const t=$(this).parent().parent(),a=$(this).parent().prev()[0].getBoundingClientRect().height;$(this).hasClass("show")?($(this).removeClass("show"),t.css("height","72px")):($(this).addClass("show"),t.css("height",`${a+40}px`))}),this.init=async function(){o.category.find(".category-list").height()<35&&o.category.find(".mdi").parent().remove(),i(),c();try{await a(),l.maxPageIndex>1?n(l.pageIndex):o.pagination.remove()}finally{window.lycoris.loading.hide()}window.lycoris.record("首页")},this.init()});