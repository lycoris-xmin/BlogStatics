$(function(){$.fn.table=function(){function e(){if(null!=p.columns&&p.columns.length>0){d.columns=p.options.showCheckbox?[{field:"check",checkbox:!0}]:[];for(let e of p.columns){let o={field:e.column,title:e.title};null!=e.width&&(o.width=e.width),null==e.display||"boolean"!=typeof e.display||e.display||(o.visible=!1),null!=e.sortable&&"boolean"==typeof e.sortable?o.sortable=e.sortable:o.sortable=!1,null!=e.align?o.align=e.align:o.align="left",(null!=e.cellStyle||null!=e.class&&""!=e.class)&&(o.cellStyle=function(){let o={css:e.cellStyle,classes:e.class};return null==o.css&&delete o.css,null==o.classes&&delete o.classes,o}),null!=e.render&&"function"==typeof e.render&&(o.formatter=e.render),null!=e.events&&"object"==typeof e.events&&(o.events=e.events),d.columns.push(o)}}}async function o(e,o){$(p).bootstrapTable("showLoading");try{let t=await p.request(e,o);const i={total:t.count||0,rows:t.list||[]};return p.data.total=t.count||0,p.data.rows=t.list||[],p.pageIndex=e,p.pageSize=o,i}finally{$(p).bootstrapTable("hideLoading")}}function t(){const e='\n      <div class="table-preloader">\n        <div class="table-preloader-inner"></div>\n        <p class="table-text">数据加载中,请稍后...</p>\n      </div>\n      ';$(p).parent().find("div.fixed-table-loading").html(e)}function i(e){$(p).bootstrapTable("load",e),n(e.total),null!=p.loadCompelte&&"function"==typeof p.loadCompelte&&p.loadCompelte(e)}function n(e){e>0?$(p).parent().addClass("show"):$(p).parent().removeClass("show")}function s(e,o,t){for(var i={},n=0;n<e.length;n++)for(var s in e[n])if(s==o){var a=e[n][s];i.hasOwnProperty(a)?i[a]=1*i[a]+1:i[a]=1;break}var l=0;for(var s in i){var r=1*i[s];$(p).bootstrapTable("mergeCells",{index:l,field:o,colspan:t,rowspan:r}),l+=r}}function a(e,o,t){var i;return function(){var n=this,s=arguments;if(i&&clearTimeout(i),t){var a=!i;i=setTimeout(function(){e.apply(n,s)},o),a&&e.apply(n,s)}else i=setTimeout(function(){e.apply(n,s)},o)}}function l(e){e>1920?$(p).hasClass("filter-row-1")||$(p).hasClass("filter-lg-row-1")?p.options.height=.72*window.screen.height:$(p).hasClass("filter-row-2")||$(p).hasClass("filter-lg-row-2")?p.options.height=.66*window.screen.height:p.options.height=.78*window.screen.height:e>1366?$(p).hasClass("filter-row-1")||$(p).hasClass("filter-md-row-1")?p.options.height=.75*window.screen.height:$(p).hasClass("filter-row-2")||$(p).hasClass("filter-md-row-2")?p.options.height=.67*window.screen.height:p.options.height=.84*window.screen.height:e>=1024&&($(p).hasClass("filter-row-1")||$(p).hasClass("filter-sm-row-1")?p.options.height=.75*window.screen.height:$(p).hasClass("filter-row-2")||$(p).hasClass("filter-sm-row-2")?p.options.height=.67*window.screen.height:p.options.height=.84*window.screen.height)}function r(e){("boolean"!=typeof p.options.pageSizeResize||p.options.pageSizeResize)&&(e>1920?(p.pageOptions.pageSize=20,p.pageOptions.pageList=[20,50]):e>1366?(p.pageOptions.pageSize=15,p.pageOptions.pageList=[15,20,50]):e>=1024&&(e>1180?(p.pageOptions.pageSize=10,p.pageOptions.pageList=[10,20,50]):(p.pageOptions.pageSize=5,p.pageOptions.pageList=[5,10,20])))}const p=this,c={index:1,size:10},d={classes:"table table-bordered table-hover table-striped",uniqueId:"id",idField:"id",onColumnSwitch:function(){var e=$("#tb_departments").bootstrapTable("getData",!0);s(e,"nationality",1,$("#tb_departments")),s(e,"category",1,$("#tb_departments"))},onLoadSuccess:function(e){$("[data-toggle='tooltip']").tooltip();e=$("#tb_departments").bootstrapTable("getData",!0);s(e,"nationality",1,$("#tb_departments")),s(e,"category",1,$("#tb_departments"))},onCheck:function(e){if(void 0===p.events.check&&"function"!=typeof p.events.check)return!1;p.events.check(e)},onClickRow:function(e,o){if(void 0===p.events.clickRow&&"function"!=typeof p.events.checkSome)return!1;p.events.clickRow(e,o)},onCheckSome:function(e){if(void 0===p.events.checkSome&&"function"!=typeof p.events.checkSome)return!1;p.events.checkSome(e)},onUncheckSome:function(e){if(void 0===p.events.uncheckSome&&"function"!=typeof p.events.uncheckSome)return!1;p.events.uncheckSome(e)},formatNoMatches:void 0,formatLoadingMessage:void 0},h={screenWidthRecord:0};return p.pageIndex=1,p.pageSize=10,p.data={rows:[],total:0},p.options={toolbar:void 0,toolbarAlign:"left",clickToSelect:!1,showCheckbox:!0,showColumns:!0,showHeader:!0,showRefresh:!1,showToggle:!1,pagination:!0,sortOrder:"asc",sidePagination:"server",fixedColumns:!1,height:"",resize:!1,autoHeight:!1,pageSizeResize:!1},p.events={check:void 0,clickRow:void 0,checkSome:void 0,uncheckSome:void 0},p.column=[],p.request=function(e,o){return{rows:[],total:0}},p.pageOptions={pageIndex:1,pageSize:20,pageList:[20,50,100]},p.init=function(){void 0===p.pageOptions&&(p.pageOptions={pageIndex:1,pageSize:20,pageList:[20,50,100]}),null==p.options&&(p.options={toolbar:void 0,showHeader:!0,showColumns:!0,showRefresh:!1,showToggle:!1,pagination:!0,sortOrder:"asc",sidePagination:"server",height:"",resize:!1,autoHeight:!1,pageSizeResize:!1}),p.options.autoHeight&&l(window.screen.width),p.options.pageSizeResize&&r(window.screen.width),d.pageNumber=p.pageOptions.pageIndex||1,d.pageSize=p.pageOptions.pageSize||10,d.pageList=p.pageOptions.pageList||[10,20,50,100],c.index=p.pageOptions.pageIndex,c.size=p.pageOptions.pageSize,p.pageIndex=p.pageOptions.pageIndex,p.pageSize=p.pageOptions.pageSize,null!=p.options.toolbar&&(d.toolbar=this.options.toolbar),d.clickToSelect=p.options.clickToSelect,d.showHeader=p.options.showHeader,d.showColumns=p.options.showColumns,d.showRefresh=p.options.showRefresh,d.showToggle=p.options.showToggle,d.showToggle&&(d.clickToSelect=!1),d.pagination=p.options.pagination,d.sortOrder=p.options.sortOrder,d.sidePagination=p.options.sidePagination,p.options.formatNoMatches&&"function"==typeof p.options.formatNoMatches&&(d.formatNoMatches=p.options.formatNoMatches),p.options.formatLoadingMessage&&"function"==typeof p.options.formatLoadingMessage&&(d.formatLoadingMessage=p.options.formatLoadingMessage),p.options.fixedColumns&&(d.fixedColumns=!0,null!=p.options.fixedNumber&&""!=p.options.fixedNumber&&(d.fixedNumber=p.options.fixedNumber),null!=p.options.fixedRightNumber&&""!=p.options.fixedRightNumber&&(d.fixedRightNumber=p.options.fixedRightNumber)),null!=p.options.resize&&"boolean"==typeof p.options.resize||(p.options.resize=!1),p.options.height&&"number"==typeof p.options.height&&(d.height=p.options.height),e(),$(p).bootstrapTable(d),t(),null==p.options.toolbar&&$("div.bootstrap-table").find("div.fixed-table-toolbar").hide(),$(p).on("page-change.bs.table",async function(e,o,t){c.index=o,c.size=t,"server"===p.options.sidePagination&&await p.pageIndexChange(o,t)}),$(p).bootstrapTable("hideLoading"),p.options.resize&&(h.screenWidthRecord=window.screen.width,window.onresize=a(()=>{h.screenWidthRecord!=window.screen.width&&(p.destroy(),l(window.screen.width),r(window.screen.width),p.init(),p.reload(),h.screenWidthRecord=window.screen.width)},500))},p.pageIndexChange=async function(e,t){let n=await o(e,t).catch(e=>{throw e});i(n)},p.selectPage=async function(e){if(null==e||"number"!=typeof e)return;$(p).bootstrapTable("selectPage",e),c.index=e;let t=o(c.index,c.size).catch(e=>{throw e});i(t)},p.destroy=function(){$(p).bootstrapTable("destroy"),c.index=1},p.getData=(()=>$(p).bootstrapTable("getData",!0)),p.getSelectRows=(()=>$(p).bootstrapTable("getSelections")),p.selectPage=(e=>$(p).bootstrapTable("selectPage",e)),p.totalRows=(()=>$(p).bootstrapTable("getOptions").totalRows||0),p.removeAll=(()=>$(p).bootstrapTable("removeAll")),p.createRow=function(e,o=!0){if(e){let t=$(p).bootstrapTable("getData",!0)||[],n=$(p).bootstrapTable("getOptions").totalRows||0;if(o){if(t.length==p.pageSize)return;t.push(e)}else t.unshift(e),t.length>p.pageOptions.pageSize&&t.pop();n+=1,i({rows:t,total:n})}},p.updateRow=function(e,o){null!=e&&"number"==typeof e&&e>-1&&$(p).bootstrapTable("updateRow",{index:e,row:o})},p.removeRow=function(e,o){if(o){let t=$(p).bootstrapTable("getData",!0),i=$(p).bootstrapTable("getOptions").totalRows,s={field:e,values:[]};Array.isArray(o)?s.values=o:s.values.push(o),1==c.index?t.length<c.size||t.length==i?$(p).bootstrapTable("remove",s):p.load():t.length>1?t.length<c.size?$(p).bootstrapTable("remove",s):p.reload():p.load(c.index-1),n(i-1)}},p.setData=function(e,o){e=e||[],o=o||e.length,i({rows:e,total:o})},this.load=async function(e=1){c.index=e;let t=await o(c.index,c.size).catch(e=>{throw e});i(t)},this.reload=async function(){let e=await o(c.index,c.size).catch(e=>{throw e});i(e)},this.loading={show:function(){$(p).find("div.loading-preloader").addClass("loading")},hide:function(){$(p).find("div.loading-preloader").removeClass("loading")}},p}});