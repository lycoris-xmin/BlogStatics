import{config,elementClosest,EmitterMixin,applyStyle,whenTransitionDone,removeElement,ScrollController,ElementScrollController,computeInnerRect,WindowScrollController,preventSelection,preventContextMenu,allowSelection,allowContextMenu,ElementDragging,computeRect,getClippingParents,pointInsideRect,isDateSpansEqual,constrainPoint,intersectRects,getRectCenter,diffPoints,mapHash,rangeContainsRange,interactionSettingsToStore,Interaction,enableCursor,disableCursor,compareNumbers,getElSeg,getRelevantEvents,EventApi,createEmptyEventStore,applyMutationToEventStore,interactionSettingsStore,startOfDay,diffDates,createDuration,eventTupleToStore,isInteractionValid,parseDragMeta,elementMatches,parseEventDef,createEventInstance,globalDefaults,createPlugin}from"@fullcalendar/core";var extendStatics=function(e,t){return(extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}))(e,t)};function __extends(e,t){function n(){this.constructor=e}extendStatics(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var __assign=function(){return(__assign=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},ignoreMouseDepth=(config.touchMouseIgnoreWait=500,0),listenerCnt=0,isWindowTouchMoveCancelled=!1,PointerDragging=function(){function e(e){var r=this;this.subjectEl=null,this.downEl=null,this.selector="",this.handleSelector="",this.shouldIgnoreMove=!1,this.shouldWatchScroll=!0,this.isDragging=!1,this.isTouchDragging=!1,this.wasTouchScroll=!1,this.handleMouseDown=function(e){!r.shouldIgnoreMouse()&&isPrimaryMouseButton(e)&&r.tryStart(e)&&(e=r.createEventFromMouse(e,!0),r.emitter.trigger("pointerdown",e),r.initScrollWatch(e),r.shouldIgnoreMove||document.addEventListener("mousemove",r.handleMouseMove),document.addEventListener("mouseup",r.handleMouseUp))},this.handleMouseMove=function(e){e=r.createEventFromMouse(e);r.recordCoords(e),r.emitter.trigger("pointermove",e)},this.handleMouseUp=function(e){document.removeEventListener("mousemove",r.handleMouseMove),document.removeEventListener("mouseup",r.handleMouseUp),r.emitter.trigger("pointerup",r.createEventFromMouse(e)),r.cleanup()},this.handleTouchStart=function(e){var t;r.tryStart(e)&&(r.isTouchDragging=!0,t=r.createEventFromTouch(e,!0),r.emitter.trigger("pointerdown",t),r.initScrollWatch(t),t=e.target,r.shouldIgnoreMove||t.addEventListener("touchmove",r.handleTouchMove),t.addEventListener("touchend",r.handleTouchEnd),t.addEventListener("touchcancel",r.handleTouchEnd),window.addEventListener("scroll",r.handleTouchScroll,!0))},this.handleTouchMove=function(e){e=r.createEventFromTouch(e);r.recordCoords(e),r.emitter.trigger("pointermove",e)},this.handleTouchEnd=function(e){var t;r.isDragging&&((t=e.target).removeEventListener("touchmove",r.handleTouchMove),t.removeEventListener("touchend",r.handleTouchEnd),t.removeEventListener("touchcancel",r.handleTouchEnd),window.removeEventListener("scroll",r.handleTouchScroll,!0),r.emitter.trigger("pointerup",r.createEventFromTouch(e)),r.cleanup(),r.isTouchDragging=!1,startIgnoringMouse())},this.handleTouchScroll=function(){r.wasTouchScroll=!0},this.handleScroll=function(e){var t,n;r.shouldIgnoreMove||(t=window.pageXOffset-r.prevScrollX+r.prevPageX,n=window.pageYOffset-r.prevScrollY+r.prevPageY,r.emitter.trigger("pointermove",{origEvent:e,isTouch:r.isTouchDragging,subjectEl:r.subjectEl,pageX:t,pageY:n,deltaX:t-r.origPageX,deltaY:n-r.origPageY}))},this.containerEl=e,this.emitter=new EmitterMixin,e.addEventListener("mousedown",this.handleMouseDown),e.addEventListener("touchstart",this.handleTouchStart,{passive:!0}),listenerCreated()}return e.prototype.destroy=function(){this.containerEl.removeEventListener("mousedown",this.handleMouseDown),this.containerEl.removeEventListener("touchstart",this.handleTouchStart,{passive:!0}),listenerDestroyed()},e.prototype.tryStart=function(e){var t=this.querySubjectEl(e),e=e.target;return!(!t||this.handleSelector&&!elementClosest(e,this.handleSelector)||(this.subjectEl=t,this.downEl=e,this.isDragging=!0,this.wasTouchScroll=!1))},e.prototype.cleanup=function(){isWindowTouchMoveCancelled=!1,this.isDragging=!1,this.subjectEl=null,this.downEl=null,this.destroyScrollWatch()},e.prototype.querySubjectEl=function(e){return this.selector?elementClosest(e.target,this.selector):this.containerEl},e.prototype.shouldIgnoreMouse=function(){return ignoreMouseDepth||this.isTouchDragging},e.prototype.cancelTouchScroll=function(){this.isDragging&&(isWindowTouchMoveCancelled=!0)},e.prototype.initScrollWatch=function(e){this.shouldWatchScroll&&(this.recordCoords(e),window.addEventListener("scroll",this.handleScroll,!0))},e.prototype.recordCoords=function(e){this.shouldWatchScroll&&(this.prevPageX=e.pageX,this.prevPageY=e.pageY,this.prevScrollX=window.pageXOffset,this.prevScrollY=window.pageYOffset)},e.prototype.destroyScrollWatch=function(){this.shouldWatchScroll&&window.removeEventListener("scroll",this.handleScroll,!0)},e.prototype.createEventFromMouse=function(e,t){var n=0,r=0;return t?(this.origPageX=e.pageX,this.origPageY=e.pageY):(n=e.pageX-this.origPageX,r=e.pageY-this.origPageY),{origEvent:e,isTouch:!1,subjectEl:this.subjectEl,pageX:e.pageX,pageY:e.pageY,deltaX:n,deltaY:r}},e.prototype.createEventFromTouch=function(e,t){var n,r=e.touches,i=0,o=0,r=(r&&r.length?(n=r[0].pageX,r[0]):(n=e.pageX,e)).pageY;return t?(this.origPageX=n,this.origPageY=r):(i=n-this.origPageX,o=r-this.origPageY),{origEvent:e,isTouch:!0,subjectEl:this.subjectEl,pageX:n,pageY:r,deltaX:i,deltaY:o}},e}();function isPrimaryMouseButton(e){return 0===e.button&&!e.ctrlKey}function startIgnoringMouse(){ignoreMouseDepth++,setTimeout(function(){ignoreMouseDepth--},config.touchMouseIgnoreWait)}function listenerCreated(){listenerCnt++||window.addEventListener("touchmove",onWindowTouchMove,{passive:!1})}function listenerDestroyed(){--listenerCnt||window.removeEventListener("touchmove",onWindowTouchMove,{passive:!1})}function onWindowTouchMove(e){isWindowTouchMoveCancelled&&e.preventDefault()}var ElementMirror=function(){function e(){this.isVisible=!1,this.sourceEl=null,this.mirrorEl=null,this.sourceElRect=null,this.parentNode=document.body,this.zIndex=9999,this.revertDuration=0}return e.prototype.start=function(e,t,n){this.sourceEl=e,this.sourceElRect=this.sourceEl.getBoundingClientRect(),this.origScreenX=t-window.pageXOffset,this.origScreenY=n-window.pageYOffset,this.deltaX=0,this.deltaY=0,this.updateElPosition()},e.prototype.handleMove=function(e,t){this.deltaX=e-window.pageXOffset-this.origScreenX,this.deltaY=t-window.pageYOffset-this.origScreenY,this.updateElPosition()},e.prototype.setIsVisible=function(e){e?this.isVisible||(this.mirrorEl&&(this.mirrorEl.style.display=""),this.isVisible=e,this.updateElPosition()):this.isVisible&&(this.mirrorEl&&(this.mirrorEl.style.display="none"),this.isVisible=e)},e.prototype.stop=function(e,t){function n(){r.cleanup(),t()}var r=this;e&&this.mirrorEl&&this.isVisible&&this.revertDuration&&(this.deltaX||this.deltaY)?this.doRevertAnimation(n,this.revertDuration):setTimeout(n,0)},e.prototype.doRevertAnimation=function(e,t){var n=this.mirrorEl,r=this.sourceEl.getBoundingClientRect();n.style.transition="top "+t+"ms,left "+t+"ms",applyStyle(n,{left:r.left,top:r.top}),whenTransitionDone(n,function(){n.style.transition="",e()})},e.prototype.cleanup=function(){this.mirrorEl&&(removeElement(this.mirrorEl),this.mirrorEl=null),this.sourceEl=null},e.prototype.updateElPosition=function(){this.sourceEl&&this.isVisible&&applyStyle(this.getMirrorEl(),{left:this.sourceElRect.left+this.deltaX,top:this.sourceElRect.top+this.deltaY})},e.prototype.getMirrorEl=function(){var e=this.sourceElRect,t=this.mirrorEl;return t||((t=this.mirrorEl=this.sourceEl.cloneNode(!0)).classList.add("fc-unselectable"),t.classList.add("fc-dragging"),applyStyle(t,{position:"fixed",zIndex:this.zIndex,visibility:"",boxSizing:"border-box",width:e.right-e.left,height:e.bottom-e.top,right:"auto",bottom:"auto",margin:0}),this.parentNode.appendChild(t)),t},e}(),ScrollGeomCache=function(r){function e(e,t){var n=r.call(this)||this;return n.handleScroll=function(){n.scrollTop=n.scrollController.getScrollTop(),n.scrollLeft=n.scrollController.getScrollLeft(),n.handleScrollChange()},n.scrollController=e,n.doesListening=t,n.scrollTop=n.origScrollTop=e.getScrollTop(),n.scrollLeft=n.origScrollLeft=e.getScrollLeft(),n.scrollWidth=e.getScrollWidth(),n.scrollHeight=e.getScrollHeight(),n.clientWidth=e.getClientWidth(),n.clientHeight=e.getClientHeight(),n.clientRect=n.computeClientRect(),n.doesListening&&n.getEventTarget().addEventListener("scroll",n.handleScroll),n}return __extends(e,r),e.prototype.destroy=function(){this.doesListening&&this.getEventTarget().removeEventListener("scroll",this.handleScroll)},e.prototype.getScrollTop=function(){return this.scrollTop},e.prototype.getScrollLeft=function(){return this.scrollLeft},e.prototype.setScrollTop=function(e){this.scrollController.setScrollTop(e),this.doesListening||(this.scrollTop=Math.max(Math.min(e,this.getMaxScrollTop()),0),this.handleScrollChange())},e.prototype.setScrollLeft=function(e){this.scrollController.setScrollLeft(e),this.doesListening||(this.scrollLeft=Math.max(Math.min(e,this.getMaxScrollLeft()),0),this.handleScrollChange())},e.prototype.getClientWidth=function(){return this.clientWidth},e.prototype.getClientHeight=function(){return this.clientHeight},e.prototype.getScrollWidth=function(){return this.scrollWidth},e.prototype.getScrollHeight=function(){return this.scrollHeight},e.prototype.handleScrollChange=function(){},e}(ScrollController),ElementScrollGeomCache=function(n){function e(e,t){return n.call(this,new ElementScrollController(e),t)||this}return __extends(e,n),e.prototype.getEventTarget=function(){return this.scrollController.el},e.prototype.computeClientRect=function(){return computeInnerRect(this.scrollController.el)},e}(ScrollGeomCache),WindowScrollGeomCache=function(t){function e(e){return t.call(this,new WindowScrollController,e)||this}return __extends(e,t),e.prototype.getEventTarget=function(){return window},e.prototype.computeClientRect=function(){return{left:this.scrollLeft,right:this.scrollLeft+this.clientWidth,top:this.scrollTop,bottom:this.scrollTop+this.clientHeight}},e.prototype.handleScrollChange=function(){this.clientRect=this.computeClientRect()},e}(ScrollGeomCache),getTime=("function"==typeof performance?performance:Date).now,AutoScroller=function(){function e(){var n=this;this.isEnabled=!0,this.scrollQuery=[window,".fc-scroller"],this.edgeThreshold=50,this.maxVelocity=300,this.pointerScreenX=null,this.pointerScreenY=null,this.isAnimating=!1,this.scrollCaches=null,this.everMovedUp=!1,this.everMovedDown=!1,this.everMovedLeft=!1,this.everMovedRight=!1,this.animate=function(){var e,t;n.isAnimating&&((e=n.computeBestEdge(n.pointerScreenX+window.pageXOffset,n.pointerScreenY+window.pageYOffset))?(t=getTime(),n.handleSide(e,(t-n.msSinceRequest)/1e3),n.requestAnimation(t)):n.isAnimating=!1)}}return e.prototype.start=function(e,t){this.isEnabled&&(this.scrollCaches=this.buildCaches(),this.pointerScreenX=null,this.pointerScreenY=null,this.everMovedUp=!1,this.everMovedDown=!1,this.everMovedLeft=!1,this.everMovedRight=!1,this.handleMove(e,t))},e.prototype.handleMove=function(e,t){var n,r;this.isEnabled&&(e=e-window.pageXOffset,t=t-window.pageYOffset,n=null===this.pointerScreenY?0:t-this.pointerScreenY,r=null===this.pointerScreenX?0:e-this.pointerScreenX,n<0?this.everMovedUp=!0:0<n&&(this.everMovedDown=!0),r<0?this.everMovedLeft=!0:0<r&&(this.everMovedRight=!0),this.pointerScreenX=e,this.pointerScreenY=t,this.isAnimating||(this.isAnimating=!0,this.requestAnimation(getTime())))},e.prototype.stop=function(){if(this.isEnabled){this.isAnimating=!1;for(var e=0,t=this.scrollCaches;e<t.length;e++)t[e].destroy();this.scrollCaches=null}},e.prototype.requestAnimation=function(e){this.msSinceRequest=e,requestAnimationFrame(this.animate)},e.prototype.handleSide=function(e,t){var n=e.scrollCache,r=this.edgeThreshold,i=r-e.distance,o=i*i/(r*r)*this.maxVelocity*t,a=1;switch(e.name){case"left":a=-1;case"right":n.setScrollLeft(n.getScrollLeft()+o*a);break;case"top":a=-1;case"bottom":n.setScrollTop(n.getScrollTop()+o*a)}},e.prototype.computeBestEdge=function(e,t){for(var n=this.edgeThreshold,r=null,i=0,o=this.scrollCaches;i<o.length;i++){var a=o[i],l=a.clientRect,s=e-l.left,c=l.right-e,g=t-l.top,l=l.bottom-t;0<=s&&0<=c&&0<=g&&0<=l&&(g<=n&&this.everMovedUp&&a.canScrollUp()&&(!r||r.distance>g)&&(r={scrollCache:a,name:"top",distance:g}),l<=n&&this.everMovedDown&&a.canScrollDown()&&(!r||r.distance>l)&&(r={scrollCache:a,name:"bottom",distance:l}),s<=n&&this.everMovedLeft&&a.canScrollLeft()&&(!r||r.distance>s)&&(r={scrollCache:a,name:"left",distance:s}),c<=n)&&this.everMovedRight&&a.canScrollRight()&&(!r||r.distance>c)&&(r={scrollCache:a,name:"right",distance:c})}return r},e.prototype.buildCaches=function(){return this.queryScrollEls().map(function(e){return e===window?new WindowScrollGeomCache(!1):new ElementScrollGeomCache(e,!1)})},e.prototype.queryScrollEls=function(){for(var e=[],t=0,n=this.scrollQuery;t<n.length;t++){var r=n[t];"object"==typeof r?e.push(r):e.push.apply(e,Array.prototype.slice.call(document.querySelectorAll(r)))}return e},e}(),FeaturefulElementDragging=function(t){function e(e){var n=t.call(this,e)||this,e=(n.delay=null,n.minDistance=0,n.touchScrollAllowed=!0,n.mirrorNeedsRevert=!1,n.isInteracting=!1,n.isDragging=!1,n.isDelayEnded=!1,n.isDistanceSurpassed=!1,n.delayTimeoutId=null,n.onPointerDown=function(e){n.isDragging||(n.isInteracting=!0,n.isDelayEnded=!1,n.isDistanceSurpassed=!1,preventSelection(document.body),preventContextMenu(document.body),e.isTouch||e.origEvent.preventDefault(),n.emitter.trigger("pointerdown",e),n.pointer.shouldIgnoreMove)||(n.mirror.setIsVisible(!1),n.mirror.start(e.subjectEl,e.pageX,e.pageY),n.startDelay(e),n.minDistance)||n.handleDistanceSurpassed(e)},n.onPointerMove=function(e){var t;n.isInteracting&&(n.emitter.trigger("pointermove",e),n.isDistanceSurpassed||(t=n.minDistance)*t<=(t=e.deltaX)*t+(t=e.deltaY)*t&&n.handleDistanceSurpassed(e),n.isDragging)&&("scroll"!==e.origEvent.type&&(n.mirror.handleMove(e.pageX,e.pageY),n.autoScroller.handleMove(e.pageX,e.pageY)),n.emitter.trigger("dragmove",e))},n.onPointerUp=function(e){n.isInteracting&&(n.isInteracting=!1,allowSelection(document.body),allowContextMenu(document.body),n.emitter.trigger("pointerup",e),n.isDragging&&(n.autoScroller.stop(),n.tryStopDrag(e)),n.delayTimeoutId)&&(clearTimeout(n.delayTimeoutId),n.delayTimeoutId=null)},n.pointer=new PointerDragging(e));return e.emitter.on("pointerdown",n.onPointerDown),e.emitter.on("pointermove",n.onPointerMove),e.emitter.on("pointerup",n.onPointerUp),n.mirror=new ElementMirror,n.autoScroller=new AutoScroller,n}return __extends(e,t),e.prototype.destroy=function(){this.pointer.destroy()},e.prototype.startDelay=function(e){var t=this;"number"==typeof this.delay?this.delayTimeoutId=setTimeout(function(){t.delayTimeoutId=null,t.handleDelayEnd(e)},this.delay):this.handleDelayEnd(e)},e.prototype.handleDelayEnd=function(e){this.isDelayEnded=!0,this.tryStartDrag(e)},e.prototype.handleDistanceSurpassed=function(e){this.isDistanceSurpassed=!0,this.tryStartDrag(e)},e.prototype.tryStartDrag=function(e){this.isDelayEnded&&this.isDistanceSurpassed&&(this.pointer.wasTouchScroll&&!this.touchScrollAllowed||(this.isDragging=!0,this.mirrorNeedsRevert=!1,this.autoScroller.start(e.pageX,e.pageY),this.emitter.trigger("dragstart",e),!1===this.touchScrollAllowed&&this.pointer.cancelTouchScroll()))},e.prototype.tryStopDrag=function(e){this.mirror.stop(this.mirrorNeedsRevert,this.stopDrag.bind(this,e))},e.prototype.stopDrag=function(e){this.isDragging=!1,this.emitter.trigger("dragend",e)},e.prototype.setIgnoreMove=function(e){this.pointer.shouldIgnoreMove=e},e.prototype.setMirrorIsVisible=function(e){this.mirror.setIsVisible(e)},e.prototype.setMirrorNeedsRevert=function(e){this.mirrorNeedsRevert=e},e.prototype.setAutoScrollEnabled=function(e){this.autoScroller.isEnabled=e},e}(ElementDragging),OffsetTracker=function(){function e(e){this.origRect=computeRect(e),this.scrollCaches=getClippingParents(e).map(function(e){return new ElementScrollGeomCache(e,!0)})}return e.prototype.destroy=function(){for(var e=0,t=this.scrollCaches;e<t.length;e++)t[e].destroy()},e.prototype.computeLeft=function(){for(var e=this.origRect.left,t=0,n=this.scrollCaches;t<n.length;t++){var r=n[t];e+=r.origScrollLeft-r.getScrollLeft()}return e},e.prototype.computeTop=function(){for(var e=this.origRect.top,t=0,n=this.scrollCaches;t<n.length;t++){var r=n[t];e+=r.origScrollTop-r.getScrollTop()}return e},e.prototype.isWithinClipping=function(e,t){for(var n={left:e,top:t},r=0,i=this.scrollCaches;r<i.length;r++){var o=i[r];if(!isIgnoredClipping(o.getEventTarget())&&!pointInsideRect(n,o.clientRect))return!1}return!0},e}();function isIgnoredClipping(e){e=e.tagName;return"HTML"===e||"BODY"===e}var HitDragging=function(){function e(e,t){var n=this;this.useSubjectCenter=!1,this.requireInitial=!0,this.initialHit=null,this.movingHit=null,this.finalHit=null,this.handlePointerDown=function(e){var t=n.dragging;n.initialHit=null,n.movingHit=null,n.finalHit=null,n.prepareHits(),n.processFirstCoord(e),n.initialHit||!n.requireInitial?(t.setIgnoreMove(!1),n.emitter.trigger("pointerdown",e)):t.setIgnoreMove(!0)},this.handleDragStart=function(e){n.emitter.trigger("dragstart",e),n.handleMove(e,!0)},this.handleDragMove=function(e){n.emitter.trigger("dragmove",e),n.handleMove(e)},this.handlePointerUp=function(e){n.releaseHits(),n.emitter.trigger("pointerup",e)},this.handleDragEnd=function(e){n.movingHit&&n.emitter.trigger("hitupdate",null,!0,e),n.finalHit=n.movingHit,n.movingHit=null,n.emitter.trigger("dragend",e)},this.droppableStore=t,e.emitter.on("pointerdown",this.handlePointerDown),e.emitter.on("dragstart",this.handleDragStart),e.emitter.on("dragmove",this.handleDragMove),e.emitter.on("pointerup",this.handlePointerUp),e.emitter.on("dragend",this.handleDragEnd),this.dragging=e,this.emitter=new EmitterMixin}return e.prototype.processFirstCoord=function(e){var t,n={left:e.pageX,top:e.pageY},r=n,e=e.subjectEl,e=(e!==document&&(t=computeRect(e),r=constrainPoint(r,t)),this.initialHit=this.queryHitForOffset(r.left,r.top));e?(this.useSubjectCenter&&t&&(t=intersectRects(t,e.rect))&&(r=getRectCenter(t)),this.coordAdjust=diffPoints(r,n)):this.coordAdjust={left:0,top:0}},e.prototype.handleMove=function(e,t){var n=this.queryHitForOffset(e.pageX+this.coordAdjust.left,e.pageY+this.coordAdjust.top);!t&&isHitsEqual(this.movingHit,n)||(this.movingHit=n,this.emitter.trigger("hitupdate",n,!1,e))},e.prototype.prepareHits=function(){this.offsetTrackers=mapHash(this.droppableStore,function(e){return e.component.buildPositionCaches(),new OffsetTracker(e.el)})},e.prototype.releaseHits=function(){var e,t=this.offsetTrackers;for(e in t)t[e].destroy();this.offsetTrackers={}},e.prototype.queryHitForOffset=function(e,t){var n,r=this.droppableStore,i=this.offsetTrackers,o=null;for(n in r){var a,l,s,c,g,u=r[n].component,d=i[n];d.isWithinClipping(e,t)&&(a=d.computeLeft(),s=t-(l=d.computeTop()),c=(d=d.origRect).right-d.left,d=d.bottom-d.top,0<=(g=e-a))&&g<c&&0<=s&&s<d&&(!(g=u.queryHit(g,s,c,d))||u.props.dateProfile&&!rangeContainsRange(u.props.dateProfile.activeRange,g.dateSpan.range)||o&&!(g.layer>o.layer)||(g.rect.left+=a,g.rect.right+=a,g.rect.top+=l,g.rect.bottom+=l,o=g))}return o},e}();function isHitsEqual(e,t){return!e&&!t||Boolean(e)===Boolean(t)&&isDateSpansEqual(e.dateSpan,t.dateSpan)}var DateClicking=function(n){function e(e){var i=n.call(this,e)||this,t=(i.handlePointerDown=function(e){var t=i.dragging;t.setIgnoreMove(!i.component.isValidDateDownEl(t.pointer.downEl))},i.handleDragEnd=function(e){var t,n,r=i.component;i.dragging.pointer.wasTouchScroll||(t=(n=i.hitDragging).initialHit,n=n.finalHit,t&&n&&isHitsEqual(t,n)&&r.calendar.triggerDateClick(t.dateSpan,t.dayEl,r.view,e.origEvent))},e.component),t=(i.dragging=new FeaturefulElementDragging(t.el),i.dragging.autoScroller.isEnabled=!1,i.hitDragging=new HitDragging(i.dragging,interactionSettingsToStore(e)));return t.emitter.on("pointerdown",i.handlePointerDown),t.emitter.on("dragend",i.handleDragEnd),i}return __extends(e,n),e.prototype.destroy=function(){this.dragging.destroy()},e}(Interaction),DateSelecting=function(r){function e(e){var o=r.call(this,e)||this,t=(o.dragSelection=null,o.handlePointerDown=function(e){var t=o.component,n=o.dragging,r=t.opt("selectable")&&t.isValidDateDownEl(e.origEvent.target);n.setIgnoreMove(!r),n.delay=e.isTouch?getComponentTouchDelay(t):null},o.handleDragStart=function(e){o.component.calendar.unselect(e)},o.handleHitUpdate=function(e,t){var n=o.component.calendar,r=null,i=!1;!e||(r=joinHitsIntoSelection(o.hitDragging.initialHit,e,n.pluginSystem.hooks.dateSelectionTransformers))&&o.component.isDateSelectionValid(r)||(i=!0,r=null),r?n.dispatch({type:"SELECT_DATES",selection:r}):t||n.dispatch({type:"UNSELECT_DATES"}),(i?disableCursor:enableCursor)(),t||(o.dragSelection=r)},o.handlePointerUp=function(e){o.dragSelection&&(o.component.calendar.triggerDateSelect(o.dragSelection,e),o.dragSelection=null)},e.component),n=o.dragging=new FeaturefulElementDragging(t.el),n=(n.touchScrollAllowed=!1,n.minDistance=t.opt("selectMinDistance")||0,n.autoScroller.isEnabled=t.opt("dragScroll"),o.hitDragging=new HitDragging(o.dragging,interactionSettingsToStore(e)));return n.emitter.on("pointerdown",o.handlePointerDown),n.emitter.on("dragstart",o.handleDragStart),n.emitter.on("hitupdate",o.handleHitUpdate),n.emitter.on("pointerup",o.handlePointerUp),o}return __extends(e,r),e.prototype.destroy=function(){this.dragging.destroy()},e}(Interaction);function getComponentTouchDelay(e){var t=e.opt("selectLongPressDelay");return t=null==t?e.opt("longPressDelay"):t}function joinHitsIntoSelection(e,t,n){for(var r=e.dateSpan,i=t.dateSpan,i=[r.range.start,r.range.end,i.range.start,i.range.end],o=(i.sort(compareNumbers),{}),a=0,l=n;a<l.length;a++){var s=(0,l[a])(e,t);if(!1===s)return null;s&&__assign(o,s)}return o.range={start:i[0],end:i[3]},o.allDay=r.allDay,o}var EventDragging=function(r){function i(e){var E=r.call(this,e)||this,t=(E.subjectSeg=null,E.isDragging=!1,E.eventRange=null,E.relevantEvents=null,E.receivingCalendar=null,E.validMutation=null,E.mutatedRelevantEvents=null,E.handlePointerDown=function(e){var t=e.origEvent.target,n=E.component,r=E.dragging,i=r.mirror,o=n.calendar,a=E.subjectSeg=getElSeg(e.subjectEl),a=(E.eventRange=a.eventRange).instance.instanceId,a=(E.relevantEvents=getRelevantEvents(o.state.eventStore,a),r.minDistance=e.isTouch?0:n.opt("eventDragMinDistance"),r.delay=e.isTouch&&a!==n.props.eventSelection?getComponentTouchDelay$1(n):null,i.parentNode=o.el,i.revertDuration=n.opt("dragRevertDuration"),n.isValidSegDownEl(t)&&!elementClosest(t,".fc-resizer"));r.setIgnoreMove(!a),E.isDragging=a&&e.subjectEl.classList.contains("fc-draggable")},E.handleDragStart=function(e){var t=E.component.calendar,n=E.eventRange,r=n.instance.instanceId;e.isTouch?r!==E.component.props.eventSelection&&t.dispatch({type:"SELECT_EVENT",eventInstanceId:r}):t.dispatch({type:"UNSELECT_EVENT"}),E.isDragging&&(t.unselect(e),t.publiclyTrigger("eventDragStart",[{el:E.subjectSeg.el,event:new EventApi(t,n.def,n.instance),jsEvent:e.origEvent,view:E.component.view}]))},E.handleHitUpdate=function(e,t){var n,r,i,o,a,l,s,c,g;E.isDragging&&(n=E.relevantEvents,r=E.hitDragging.initialHit,i=E.component.calendar,a=o=g=null,l=!1,s={affectedEvents:n,mutatedEvents:createEmptyEventStore(),isEvent:!0,origSeg:E.subjectSeg},e&&(i===(g=(c=e.component).calendar)||c.opt("editable")&&c.opt("droppable")?(o=computeEventMutation(r,e,g.pluginSystem.hooks.eventDragMutationMassagers))&&(a=applyMutationToEventStore(n,g.eventUiBases,o,g),s.mutatedEvents=a,c.isInteractionValid(s)||(l=!0,a=o=null,s.mutatedEvents=createEmptyEventStore())):g=null),E.displayDrag(g,s),(l?disableCursor:enableCursor)(),t||(i===g&&isHitsEqual(r,e)&&(o=null),E.dragging.setMirrorNeedsRevert(!o),E.dragging.setMirrorIsVisible(!e||!document.querySelector(".fc-mirror")),E.receivingCalendar=g,E.validMutation=o,E.mutatedRelevantEvents=a))},E.handlePointerUp=function(){E.isDragging||E.cleanup()},E.handleDragEnd=function(e){if(E.isDragging){var t=E.component.calendar,n=E.component.view,r=E.receivingCalendar,i=E.validMutation,o=E.eventRange.def,a=E.eventRange.instance,l=new EventApi(t,o,a),s=E.relevantEvents,c=E.mutatedRelevantEvents,g=E.hitDragging.finalHit;if(E.clearDrag(),t.publiclyTrigger("eventDragStop",[{el:E.subjectSeg.el,event:l,jsEvent:e.origEvent,view:n}]),i)if(r===t){t.dispatch({type:"MERGE_EVENTS",eventStore:c});for(var u={},d=0,p=t.pluginSystem.hooks.eventDropTransformers;d<p.length;d++){var h=p[d];__assign(u,h(i,t))}var v=__assign({},u,{el:e.subjectEl,delta:i.datesDelta,oldEvent:l,event:new EventApi(t,c.defs[o.defId],a?c.instances[a.instanceId]:null),revert:function(){t.dispatch({type:"MERGE_EVENTS",eventStore:s})},jsEvent:e.origEvent,view:n});t.publiclyTrigger("eventDrop",[v])}else r&&(t.publiclyTrigger("eventLeave",[{draggedEl:e.subjectEl,event:l,view:n}]),t.dispatch({type:"REMOVE_EVENT_INSTANCES",instances:E.mutatedRelevantEvents.instances}),r.dispatch({type:"MERGE_EVENTS",eventStore:E.mutatedRelevantEvents}),e.isTouch&&r.dispatch({type:"SELECT_EVENT",eventInstanceId:a.instanceId}),v=__assign({},r.buildDatePointApi(g.dateSpan),{draggedEl:e.subjectEl,jsEvent:e.origEvent,view:g.component}),r.publiclyTrigger("drop",[v]),r.publiclyTrigger("eventReceive",[{draggedEl:e.subjectEl,event:new EventApi(r,c.defs[o.defId],c.instances[a.instanceId]),view:g.component}]));else t.publiclyTrigger("_noEventDrop")}E.cleanup()},E.component),n=E.dragging=new FeaturefulElementDragging(t.el),n=(n.pointer.selector=i.SELECTOR,n.touchScrollAllowed=!1,n.autoScroller.isEnabled=t.opt("dragScroll"),E.hitDragging=new HitDragging(E.dragging,interactionSettingsStore));return n.useSubjectCenter=e.useEventCenter,n.emitter.on("pointerdown",E.handlePointerDown),n.emitter.on("dragstart",E.handleDragStart),n.emitter.on("hitupdate",E.handleHitUpdate),n.emitter.on("pointerup",E.handlePointerUp),n.emitter.on("dragend",E.handleDragEnd),E}return __extends(i,r),i.prototype.destroy=function(){this.dragging.destroy()},i.prototype.displayDrag=function(e,t){var n=this.component.calendar,r=this.receivingCalendar;r&&r!==e&&(r===n?r.dispatch({type:"SET_EVENT_DRAG",state:{affectedEvents:t.affectedEvents,mutatedEvents:createEmptyEventStore(),isEvent:!0,origSeg:t.origSeg}}):r.dispatch({type:"UNSET_EVENT_DRAG"})),e&&e.dispatch({type:"SET_EVENT_DRAG",state:t})},i.prototype.clearDrag=function(){var e=this.component.calendar,t=this.receivingCalendar;t&&t.dispatch({type:"UNSET_EVENT_DRAG"}),e!==t&&e.dispatch({type:"UNSET_EVENT_DRAG"})},i.prototype.cleanup=function(){this.subjectSeg=null,this.isDragging=!1,this.eventRange=null,this.relevantEvents=null,this.receivingCalendar=null,this.validMutation=null,this.mutatedRelevantEvents=null},i.SELECTOR=".fc-draggable, .fc-resizable",i}(Interaction);function computeEventMutation(e,t,n){for(var r=e.dateSpan,i=t.dateSpan,o=r.range.start,a=i.range.start,l={},r=(r.allDay!==i.allDay&&(l.allDay=i.allDay,l.hasEnd=t.component.opt("allDayMaintainDuration"),i.allDay)&&(o=startOfDay(o)),diffDates(o,a,e.component.dateEnv,e.component===t.component?e.component.largeUnit:null)),s=(r.milliseconds&&(l.allDay=!1),{datesDelta:r,standardProps:l}),c=0,g=n;c<g.length;c++)(0,g[c])(s,e,t);return s}function getComponentTouchDelay$1(e){var t=e.opt("eventLongPressDelay");return t=null==t?e.opt("longPressDelay"):t}var EventDragging$1=function(r){function e(e){var u=r.call(this,e)||this,t=(u.draggingSeg=null,u.eventRange=null,u.relevantEvents=null,u.validMutation=null,u.mutatedRelevantEvents=null,u.handlePointerDown=function(e){var t=u.component,n=u.querySeg(e),n=u.eventRange=n.eventRange;u.dragging.minDistance=t.opt("eventDragMinDistance"),u.dragging.setIgnoreMove(!u.component.isValidSegDownEl(e.origEvent.target)||e.isTouch&&u.component.props.eventSelection!==n.instance.instanceId)},u.handleDragStart=function(e){var t=u.component.calendar,n=u.eventRange;u.relevantEvents=getRelevantEvents(t.state.eventStore,u.eventRange.instance.instanceId),u.draggingSeg=u.querySeg(e),t.unselect(),t.publiclyTrigger("eventResizeStart",[{el:u.draggingSeg.el,event:new EventApi(t,n.def,n.instance),jsEvent:e.origEvent,view:u.component.view}])},u.handleHitUpdate=function(e,t,n){var r=u.component.calendar,i=u.relevantEvents,o=u.hitDragging.initialHit,a=u.eventRange.instance,l=null,s=null,c=!1,g={affectedEvents:i,mutatedEvents:createEmptyEventStore(),isEvent:!0,origSeg:u.draggingSeg};(l=e?computeMutation(o,e,n.subjectEl.classList.contains("fc-start-resizer"),a.range,r.pluginSystem.hooks.eventResizeJoinTransforms):l)&&(s=applyMutationToEventStore(i,r.eventUiBases,l,r),g.mutatedEvents=s,u.component.isInteractionValid(g)||(c=!0,g.mutatedEvents=s=l=null)),s?r.dispatch({type:"SET_EVENT_RESIZE",state:g}):r.dispatch({type:"UNSET_EVENT_RESIZE"}),(c?disableCursor:enableCursor)(),t||(l&&isHitsEqual(o,e)&&(l=null),u.validMutation=l,u.mutatedRelevantEvents=s)},u.handleDragEnd=function(e){var t=u.component.calendar,n=u.component.view,r=u.eventRange.def,i=u.eventRange.instance,o=new EventApi(t,r,i),a=u.relevantEvents,l=u.mutatedRelevantEvents;t.publiclyTrigger("eventResizeStop",[{el:u.draggingSeg.el,event:o,jsEvent:e.origEvent,view:n}]),u.validMutation?(t.dispatch({type:"MERGE_EVENTS",eventStore:l}),t.publiclyTrigger("eventResize",[{el:u.draggingSeg.el,startDelta:u.validMutation.startDelta||createDuration(0),endDelta:u.validMutation.endDelta||createDuration(0),prevEvent:o,event:new EventApi(t,l.defs[r.defId],i?l.instances[i.instanceId]:null),revert:function(){t.dispatch({type:"MERGE_EVENTS",eventStore:a})},jsEvent:e.origEvent,view:n}])):t.publiclyTrigger("_noEventResize"),u.draggingSeg=null,u.relevantEvents=null,u.validMutation=null},e.component),n=u.dragging=new FeaturefulElementDragging(t.el),n=(n.pointer.selector=".fc-resizer",n.touchScrollAllowed=!1,n.autoScroller.isEnabled=t.opt("dragScroll"),u.hitDragging=new HitDragging(u.dragging,interactionSettingsToStore(e)));return n.emitter.on("pointerdown",u.handlePointerDown),n.emitter.on("dragstart",u.handleDragStart),n.emitter.on("hitupdate",u.handleHitUpdate),n.emitter.on("dragend",u.handleDragEnd),u}return __extends(e,r),e.prototype.destroy=function(){this.dragging.destroy()},e.prototype.querySeg=function(e){return getElSeg(elementClosest(e.subjectEl,this.component.fgSegSelector))},e}(Interaction);function computeMutation(e,t,n,r,i){for(var o=e.component.dateEnv,a=e.dateSpan.range.start,l=t.dateSpan.range.start,a=diffDates(a,l,o,e.component.largeUnit),s={},c=0,g=i;c<g.length;c++){var u=(0,g[c])(e,t);if(!1===u)return null;u&&__assign(s,u)}if(n){if(o.add(r.start,a)<r.end)return s.startDelta=a,s}else if(o.add(r.end,a)>r.start)return s.endDelta=a,s;return null}var UnselectAuto=function(){function e(e){var a=this,t=(this.isRecentPointerDateSelect=!1,this.onSelect=function(e){e.jsEvent&&(a.isRecentPointerDateSelect=!0)},this.onDocumentPointerUp=function(e){var t,n,r=a.calendar,i=a.documentPointer,o=r.state;i.wasTouchScroll||(o.dateSelection&&!a.isRecentPointerDateSelect&&(t=r.viewOpt("unselectAuto"),n=r.viewOpt("unselectCancel"),t)&&!elementClosest(i.downEl,n)&&r.unselect(e),o.eventSelection&&!elementClosest(i.downEl,EventDragging.SELECTOR)&&r.dispatch({type:"UNSELECT_EVENT"})),a.isRecentPointerDateSelect=!1},this.calendar=e,this.documentPointer=new PointerDragging(document));t.shouldIgnoreMove=!0,t.shouldWatchScroll=!1,t.emitter.on("pointerup",this.onDocumentPointerUp),e.on("select",this.onSelect)}return e.prototype.destroy=function(){this.calendar.off("select",this.onSelect),this.documentPointer.destroy()},e}(),ExternalElementDragging=function(){function e(e,t){var s=this,e=(this.receivingCalendar=null,this.droppableEvent=null,this.suppliedDragMeta=null,this.dragMeta=null,this.handleDragStart=function(e){s.dragMeta=s.buildDragMeta(e.subjectEl)},this.handleHitUpdate=function(e,t,n){var r=s.hitDragging.dragging,i=null,o=null,a=!1,l={affectedEvents:createEmptyEventStore(),mutatedEvents:createEmptyEventStore(),isEvent:s.dragMeta.create,origSeg:null};e&&(i=e.component.calendar,s.canDropElOnCalendar(n.subjectEl,i))&&(o=computeEventForDateSpan(e.dateSpan,s.dragMeta,i),l.mutatedEvents=eventTupleToStore(o),a=!isInteractionValid(l,i))&&(l.mutatedEvents=createEmptyEventStore(),o=null),s.displayDrag(i,l),r.setMirrorIsVisible(t||!o||!document.querySelector(".fc-mirror")),(a?disableCursor:enableCursor)(),t||(r.setMirrorNeedsRevert(!o),s.receivingCalendar=i,s.droppableEvent=o)},this.handleDragEnd=function(e){var t,n,r,i=s.receivingCalendar,o=s.droppableEvent;s.clearDrag(),i&&o&&(t=(r=s.hitDragging.finalHit).component.view,n=s.dragMeta,r=__assign({},i.buildDatePointApi(r.dateSpan),{draggedEl:e.subjectEl,jsEvent:e.origEvent,view:t}),i.publiclyTrigger("drop",[r]),n.create)&&(i.dispatch({type:"MERGE_EVENTS",eventStore:eventTupleToStore(o)}),e.isTouch&&i.dispatch({type:"SELECT_EVENT",eventInstanceId:o.instance.instanceId}),i.publiclyTrigger("eventReceive",[{draggedEl:e.subjectEl,event:new EventApi(i,o.def,o.instance),view:t}])),s.receivingCalendar=null,s.droppableEvent=null},this.hitDragging=new HitDragging(e,interactionSettingsStore));e.requireInitial=!1,e.emitter.on("dragstart",this.handleDragStart),e.emitter.on("hitupdate",this.handleHitUpdate),e.emitter.on("dragend",this.handleDragEnd),this.suppliedDragMeta=t}return e.prototype.buildDragMeta=function(e){return"object"==typeof this.suppliedDragMeta?parseDragMeta(this.suppliedDragMeta):"function"==typeof this.suppliedDragMeta?parseDragMeta(this.suppliedDragMeta(e)):getDragMetaFromEl(e)},e.prototype.displayDrag=function(e,t){var n=this.receivingCalendar;n&&n!==e&&n.dispatch({type:"UNSET_EVENT_DRAG"}),e&&e.dispatch({type:"SET_EVENT_DRAG",state:t})},e.prototype.clearDrag=function(){this.receivingCalendar&&this.receivingCalendar.dispatch({type:"UNSET_EVENT_DRAG"})},e.prototype.canDropElOnCalendar=function(e,t){t=t.opt("dropAccept");return"function"==typeof t?t(e):"string"!=typeof t||!t||Boolean(elementMatches(e,t))},e}();function computeEventForDateSpan(e,t,n){for(var r=__assign({},t.leftoverProps),i=0,o=n.pluginSystem.hooks.externalDefTransforms;i<o.length;i++){var a=o[i];__assign(r,a(e,t))}var l=parseEventDef(r,t.sourceId,e.allDay,n.opt("forceEventDuration")||Boolean(t.duration),n),s=e.range.start,n=(e.allDay&&t.startTime&&(s=n.dateEnv.add(s,t.startTime)),t.duration?n.dateEnv.add(s,t.duration):n.getDefaultEventEnd(e.allDay,s));return{def:l,instance:createEventInstance(l.defId,{start:s,end:n})}}function getDragMetaFromEl(e){e=getEmbeddedElData(e,"event"),e=e?JSON.parse(e):{create:!1};return parseDragMeta(e)}function getEmbeddedElData(e,t){var n=config.dataAttrPrefix;return e.getAttribute("data-"+((n?n+"-":"")+t))||""}config.dataAttrPrefix="";var ExternalDraggable=function(){function e(e,t){var i=this,e=(void 0===t&&(t={}),this.handlePointerDown=function(e){var t=i.dragging,n=i.settings,r=n.minDistance,n=n.longPressDelay;t.minDistance=null!=r?r:e.isTouch?0:globalDefaults.eventDragMinDistance,t.delay=e.isTouch?null!=n?n:globalDefaults.longPressDelay:0},this.handleDragStart=function(e){e.isTouch&&i.dragging.delay&&e.subjectEl.classList.contains("fc-event")&&i.dragging.mirror.getMirrorEl().classList.add("fc-selected")},this.settings=t,this.dragging=new FeaturefulElementDragging(e));e.touchScrollAllowed=!1,null!=t.itemSelector&&(e.pointer.selector=t.itemSelector),null!=t.appendTo&&(e.mirror.parentNode=t.appendTo),e.emitter.on("pointerdown",this.handlePointerDown),e.emitter.on("dragstart",this.handleDragStart),new ExternalElementDragging(e,t.eventData)}return e.prototype.destroy=function(){this.dragging.destroy()},e}(),InferredElementDragging=function(n){function e(e){var t=n.call(this,e)||this,e=(t.shouldIgnoreMove=!1,t.mirrorSelector="",t.currentMirrorEl=null,t.handlePointerDown=function(e){t.emitter.trigger("pointerdown",e),t.shouldIgnoreMove||t.emitter.trigger("dragstart",e)},t.handlePointerMove=function(e){t.shouldIgnoreMove||t.emitter.trigger("dragmove",e)},t.handlePointerUp=function(e){t.emitter.trigger("pointerup",e),t.shouldIgnoreMove||t.emitter.trigger("dragend",e)},t.pointer=new PointerDragging(e));return e.emitter.on("pointerdown",t.handlePointerDown),e.emitter.on("pointermove",t.handlePointerMove),e.emitter.on("pointerup",t.handlePointerUp),t}return __extends(e,n),e.prototype.destroy=function(){this.pointer.destroy()},e.prototype.setIgnoreMove=function(e){this.shouldIgnoreMove=e},e.prototype.setMirrorIsVisible=function(e){e?this.currentMirrorEl&&(this.currentMirrorEl.style.visibility="",this.currentMirrorEl=null):(e=this.mirrorSelector?document.querySelector(this.mirrorSelector):null)&&((this.currentMirrorEl=e).style.visibility="hidden")},e}(ElementDragging),ThirdPartyDraggable=function(){function e(e,t){var n=document,e=(t=e===document||e instanceof Element?(n=e,t||{}):e||{},this.dragging=new InferredElementDragging(n));"string"==typeof t.itemSelector?e.pointer.selector=t.itemSelector:n===document&&(e.pointer.selector="[data-event]"),"string"==typeof t.mirrorSelector&&(e.mirrorSelector=t.mirrorSelector),new ExternalElementDragging(e,t.eventData)}return e.prototype.destroy=function(){this.dragging.destroy()},e}(),main=createPlugin({componentInteractions:[DateClicking,DateSelecting,EventDragging,EventDragging$1],calendarInteractions:[UnselectAuto],elementDraggingImpl:FeaturefulElementDragging});export default main;export{ExternalDraggable as Draggable,FeaturefulElementDragging,PointerDragging,ThirdPartyDraggable};