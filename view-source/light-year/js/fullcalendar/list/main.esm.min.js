import{getAllDayHtml,isMultiDayRange,htmlEscape,FgEventRenderer,memoize,memoizeRendering,ScrollComponent,subtractInnerElHeight,sliceEventStore,intersectRanges,htmlToElement,createFormatter,createElement,buildGotoAnchorHtml,View,startOfDay,addDays,createPlugin}from"@fullcalendar/core";var extendStatics=function(e,t){return(extendStatics=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}))(e,t)};function __extends(e,t){function n(){this.constructor=e}extendStatics(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var ListEventRenderer=function(n){function e(e){var t=n.call(this,e.context)||this;return t.listView=e,t}return __extends(e,n),e.prototype.attachSegs=function(e){e.length?this.listView.renderSegList(e):this.listView.renderEmptyMessage()},e.prototype.detachSegs=function(){},e.prototype.renderSegHtml=function(e){var t=this.context,n=t.view,t=t.theme,r=e.eventRange,s=r.def,a=r.instance,i=r.ui,o=s.url,l=["fc-list-item"].concat(i.classNames),i=i.backgroundColor,e=s.allDay?getAllDayHtml(n):isMultiDayRange(r.range)?e.isStart?htmlEscape(this._getTimeText(a.range.start,e.end,!1)):e.isEnd?htmlEscape(this._getTimeText(e.start,a.range.end,!1)):getAllDayHtml(n):htmlEscape(this.getTimeText(r));return o&&l.push("fc-has-url"),'<tr class="'+l.join(" ")+'">'+(this.displayEventTime?'<td class="fc-list-item-time '+t.getClass("widgetContent")+'">'+(e||"")+"</td>":"")+'<td class="fc-list-item-marker '+t.getClass("widgetContent")+'"><span class="fc-event-dot"'+(i?' style="background-color:'+i+'"':"")+'></span></td><td class="fc-list-item-title '+t.getClass("widgetContent")+'"><a'+(o?' href="'+htmlEscape(o)+'"':"")+">"+htmlEscape(s.title||"")+"</a></td></tr>"},e.prototype.computeEventTimeFormat=function(){return{hour:"numeric",minute:"2-digit",meridiem:"short"}},e}(FgEventRenderer),ListView=function(l){function e(e,t,n,r){var s=l.call(this,e,t,n,r)||this,t=(s.computeDateVars=memoize(computeDateVars),s.eventStoreToSegs=memoize(s._eventStoreToSegs),s.eventRenderer=new ListEventRenderer(s));s.renderContent=memoizeRendering(t.renderSegs.bind(t),t.unrender.bind(t)),s.el.classList.add("fc-list-view");for(var a=0,i=(s.theme.getClass("listView")||"").split(" ");a<i.length;a++){var o=i[a];o&&s.el.classList.add(o)}return s.scroller=new ScrollComponent("hidden","auto"),s.el.appendChild(s.scroller.el),s.contentEl=s.scroller.el,e.calendar.registerInteractiveComponent(s,{el:s.el}),s}return __extends(e,l),e.prototype.render=function(e){var t=this.computeDateVars(e.dateProfile),n=t.dayDates,t=t.dayRanges;this.dayDates=n,this.renderContent(this.eventStoreToSegs(e.eventStore,e.eventUiBases,t))},e.prototype.destroy=function(){l.prototype.destroy.call(this),this.renderContent.unrender(),this.scroller.destroy(),this.calendar.unregisterInteractiveComponent(this)},e.prototype.updateSize=function(e,t,n){l.prototype.updateSize.call(this,e,t,n),this.eventRenderer.computeSizes(e),this.eventRenderer.assignSizes(e),this.scroller.clear(),n||this.scroller.setHeight(this.computeScrollerHeight(t))},e.prototype.computeScrollerHeight=function(e){return e-subtractInnerElHeight(this.el,this.scroller.el)},e.prototype._eventStoreToSegs=function(e,t,n){return this.eventRangesToSegs(sliceEventStore(e,t,this.props.dateProfile.activeRange,this.nextDayThreshold).fg,n)},e.prototype.eventRangesToSegs=function(e,t){for(var n=[],r=0,s=e;r<s.length;r++){var a=s[r];n.push.apply(n,this.eventRangeToSegs(a,t))}return n},e.prototype.eventRangeToSegs=function(e,t){for(var n,r=this.dateEnv,s=this.nextDayThreshold,a=e.range,i=e.def.allDay,o=[],l=0;l<t.length;l++)if((n=intersectRanges(a,t[l]))&&(n={component:this,eventRange:e,start:n.start,end:n.end,isStart:e.isStart&&n.start.valueOf()===a.start.valueOf(),isEnd:e.isEnd&&n.end.valueOf()===a.end.valueOf(),dayIndex:l},o.push(n),!n.isEnd)&&!i&&l+1<t.length&&a.end<r.add(t[l+1].start,s)){n.end=a.end,n.isEnd=!0;break}return o},e.prototype.renderEmptyMessage=function(){this.contentEl.innerHTML='<div class="fc-list-empty-wrap2"><div class="fc-list-empty-wrap1"><div class="fc-list-empty">'+htmlEscape(this.opt("noEventsMessage"))+"</div></div></div>"},e.prototype.renderSegList=function(e){for(var t,n,r=this.groupSegsByDay(e),e=htmlToElement('<table class="fc-list-table '+this.calendar.theme.getClass("tableList")+'"><tbody></tbody></table>'),s=e.querySelector("tbody"),a=0;a<r.length;a++)if(t=r[a])for(s.appendChild(this.buildDayHeaderRow(this.dayDates[a])),t=this.eventRenderer.sortEventSegs(t),n=0;n<t.length;n++)s.appendChild(t[n].el);this.contentEl.innerHTML="",this.contentEl.appendChild(e)},e.prototype.groupSegsByDay=function(e){for(var t,n=[],r=0;r<e.length;r++)(n[(t=e[r]).dayIndex]||(n[t.dayIndex]=[])).push(t);return n},e.prototype.buildDayHeaderRow=function(e){var t=this.dateEnv,n=createFormatter(this.opt("listDayFormat")),r=createFormatter(this.opt("listDayAltFormat"));return createElement("tr",{className:"fc-list-heading","data-date":t.formatIso(e,{omitTime:!0})},'<td class="'+(this.calendar.theme.getClass("tableListHeading")||this.calendar.theme.getClass("widgetHeader"))+'" colspan="3">'+(n?buildGotoAnchorHtml(this,e,{class:"fc-list-heading-main"},htmlEscape(t.format(e,n))):"")+(r?buildGotoAnchorHtml(this,e,{class:"fc-list-heading-alt"},htmlEscape(t.format(e,r))):"")+"</td>")},e}(View);function computeDateVars(e){for(var t=startOfDay(e.renderRange.start),n=e.renderRange.end,r=[],s=[];t<n;)r.push(t),s.push({start:t,end:addDays(t,1)}),t=addDays(t,1);return{dayDates:r,dayRanges:s}}ListView.prototype.fgSegSelector=".fc-list-item";var main=createPlugin({views:{list:{class:ListView,buttonTextKey:"list",listDayFormat:{month:"long",day:"numeric",year:"numeric"}},listDay:{type:"list",duration:{days:1},listDayFormat:{weekday:"long"}},listWeek:{type:"list",duration:{weeks:1},listDayFormat:{weekday:"long"},listDayAltFormat:{month:"long",day:"numeric",year:"numeric"}},listMonth:{type:"list",duration:{month:1},listDayAltFormat:{weekday:"long"}},listYear:{type:"list",duration:{year:1},listDayAltFormat:{weekday:"long"}}}});export default main;export{ListView};